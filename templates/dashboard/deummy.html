{% load static %}
<!DOCTYPE HTML>
<html lang="en">


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:32:35 GMT -->
<head>
    <meta charset="utf-8">
    <title>Evara Dashboard</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css"  />
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'dash_board/assets/imgs/theme/favicon.svg' %}">
    <!-- Template CSS -->
    <link href="{% static 'dash_board/assets/css/main.css' %}" rel="stylesheet" type="text/css" />
    {% comment %} <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css
    ">
     {% endcomment %}   
</head>

<body>
    <div class="screen-overlay"></div>
    <aside class="navbar-aside" id="offcanvas_aside">
        <div class="aside-top">
            <a href="index.html" class="brand-wrap">
                <img src="{% static 'dash_board/assets/imgs/theme/logo.svg' %}" class="logo" alt="Evara Dashboard">
            </a>
            <div>
                <button class="btn btn-icon btn-aside-minimize"> <i class="text-muted material-icons md-menu_open"></i> </button>
            </div>
        </div>
        <nav>
            <ul class="menu-aside">
                <li class="menu-item ">
                    <a class="menu-link" href="index.html"> <i class="icon material-icons md-home"></i>
                        <span class="text">Dashboard</span>
                    </a>
                </li>
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-products-list.html"> <i class="icon material-icons md-shopping_bag"></i>
                        <span class="text">Products</span>
                    </a>
                    <div class="submenu">
                        <a href="page-products-list.html">Product List</a>
                        <a href="page-products-grid.html">Product grid</a>
                        <a href="page-products-grid-2.html">Product grid 2</a>
                        <a href="page-categories.html">Categories</a>
                    </div>
                </li>
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-orders-1.html"> <i class="icon material-icons md-shopping_cart"></i>
                        <span class="text">Orders</span>
                    </a>
                    <div class="submenu">
                        <a href="page-orders-1.html">Order list 1</a>
                        <a href="page-orders-2.html">Order list 2</a>
                        <a href="page-orders-detail.html">Order detail</a>
                    </div>
                </li>
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-sellers-cards.html"> <i class="icon material-icons md-store"></i>
                        <span class="text">Sellers</span>
                    </a>
                    <div class="submenu">
                        <a href="page-sellers-cards.html">Sellers cards</a>
                        <a href="page-sellers-list.html">Sellers list</a>
                        <a href="page-seller-detail.html">Seller profile</a>
                    </div>
                </li>
                <li class="menu-item has-submenu active">
                    <a class="menu-link" href="page-form-product-1.html"> <i class="icon material-icons md-add_box"></i>
                        <span class="text">Add product</span>
                    </a>
                    <div class="submenu">
                        <a href="{% url 'dashboard:addproduct' %}">Add product </a>
                        <a href="{% url 'dashboard:addcategory' %}">Add Categories</a>
                        <a href="{% url 'dashboard:addtags' %}">Add Tags</a>
                    </div>
                </li>
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="page-transactions-1.html"> <i class="icon material-icons md-monetization_on"></i>
                        <span class="text">Transactions</span>
                    </a>
                    <div class="submenu">
                        <a href="page-transactions-1.html">Transaction 1</a>
                        <a href="page-transactions-2.html">Transaction 2</a>
                    </div>
                </li>
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="#"> <i class="icon material-icons md-person"></i>
                        <span class="text">Account</span>
                    </a>
                    <div class="submenu">
                        <a href="page-account-login.html">User login</a>
                        <a href="page-account-register.html">User registration</a>
                        <a href="page-error-404.html">Error 404</a>
                    </div>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="page-reviews.html"> <i class="icon material-icons md-comment"></i>
                        <span class="text">Reviews</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="page-brands.html"> <i class="icon material-icons md-stars"></i>
                        <span class="text">Brands</span> </a>
                </li>
                <li class="menu-item">
                    <a class="menu-link" disabled href="#"> <i class="icon material-icons md-pie_chart"></i>
                        <span class="text">Statistics</span>
                    </a>
                </li>
            </ul>
            <hr>
            <ul class="menu-aside">
                <li class="menu-item has-submenu">
                    <a class="menu-link" href="#"> <i class="icon material-icons md-settings"></i>
                        <span class="text">Settings</span>
                    </a>
                    <div class="submenu">
                        <a href="page-settings-1.html">Setting sample 1</a>
                        <a href="page-settings-2.html">Setting sample 2</a>
                    </div>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="page-blank.html"> <i class="icon material-icons md-local_offer"></i>
                        <span class="text"> Starter page </span>
                    </a>
                </li>
            </ul>
            <br>
            <br>
        </nav>
    </aside>
    <main class="main-wrap">
        <header class="main-header navbar">
            <div class="col-search">
                <form class="searchform">
                    <div class="input-group">
                        <input list="search_terms" type="text" class="form-control" placeholder="Search term">
                        <button class="btn btn-light bg" type="button"> <i class="material-icons md-search"></i></button>
                    </div>
                    <datalist id="search_terms">
                        <option value="Products">
                        <option value="New orders">
                        <option value="Apple iphone">
                        <option value="Ahmed Hassan">
                    </datalist>
                </form>
            </div>
            <div class="col-nav">
                <button class="btn btn-icon btn-mobile me-auto" data-trigger="#offcanvas_aside"> <i class="material-icons md-apps"></i> </button>
                <ul class="nav">
                    <li class="nav-item">
                        <a class="nav-link btn-icon" href="#">
                            <i class="material-icons md-notifications animation-shake"></i>
                            <span class="badge rounded-pill">3</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link btn-icon darkmode" href="#"> <i class="material-icons md-nights_stay"></i> </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="requestfullscreen nav-link btn-icon"><i class="material-icons md-cast"></i></a>
                    </li>
                    <li class="dropdown nav-item">
                        <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownLanguage" aria-expanded="false"><i class="material-icons md-public"></i></a>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownLanguage">
                            <a class="dropdown-item text-brand" href="#"><img src="{% static 'dash_board/assets/imgs/theme/flag-us.png' %}" alt="English">English</a>
                            <a class="dropdown-item" href="#"><img src="{% static 'dash_board/assets/imgs/theme/flag-fr.png' %}" alt="Français">Français</a>
                            <a class="dropdown-item" href="#"><img src="{% static 'dash_board/assets/imgs/theme/flag-jp.png' %}" alt="Français">日本語</a>
                            <a class="dropdown-item" href="#"><img src="{% static 'dash_board/assets/imgs/theme/flag-cn.png' %}" alt="Français">中国人</a>
                        </div>
                    </li>
                    <li class="dropdown nav-item">
                        <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownAccount" aria-expanded="false"> <img class="img-xs rounded-circle" src="{% static 'dash_board/assets/imgs/people/avatar2.jpg' %} "alt="User"></a>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownAccount">
                            <a class="dropdown-item" href="#"><i class="material-icons md-perm_identity"></i>Edit Profile</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-settings"></i>Account Settings</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-account_balance_wallet"></i>Wallet</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-receipt"></i>Billing</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-help_outline"></i>Help center</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item text-danger" href="#"><i class="material-icons md-exit_to_app"></i>Logout</a>
                        </div>
                    </li>
                </ul>
            </div>
        </header>
        {% if messages %}
        {% for message in messages %}
            <div class="alert {% if message.tags %}alert-{{ message.tags }}{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    <div id="accordion">
      {% for product in products %}
      <div class="card">
        <button class="btn btn-link" data-bs-toggle="collapse" data-bs-target="#collapse{{ product.name|slugify }}" aria-expanded="false" aria-controls="collapse{{ product.name|slugify }}">
        <div class="card-header" id="heading{{ product.name|slugify }}">
        
          <a class="itemside d-flex  ">
            <div class="left">
              <img src="{{product.image.url}}" class="img-thumbnail rounded custom-image" alt="Item">
            </div>
            <div class="info ml-3">
              <h6 class="mb-1">{{product.name}}</h6>
              <h10 class="mb-0">{{product.bio_name}}</h10>
              <style>
                .custom-image {
                  width: 50px; /* Set the desired width */
                  height: 50px; /* Set the desired height */
                  object-fit: cover; /* Adjust image aspect ratio */
                }
                </style>
            </div>
            <div class="col-lg-2 col-sm-2 col-4 col-status d-flex align-items-center justify-content-center">
              {% if product.is_active %}
              <span class="badge rounded-pill bg-success">Active</span>
          {% else %}
              <span class="badge rounded-pill bg-warning">Inactive</span>
          {% endif %}
          </div>
          <div class="col-1 d-flex align-items-center justify-content-end">
            <style>
                .plus-icon svg {
                    color: black;
                }
            </style>
            <i class="plus-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-plus-circle" viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                    <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                </svg>
            </i>
        </div>
          </a>

        </div>
        </button>
        <div id="collapse{{ product.name|slugify }}" class="collapse" aria-labelledby="heading{{ product.name|slugify }}" data-bs-parent="#accordion">
          <div class="card-body">
            {% for product_data in product_variants %}
            {% if product_data.product == product %}
            <h5>{{ product_data.product.name }} - variants</h5>
            {% for product_item in product_data.product_items %}
            
            <!-- Display product_item details -->
            <div>
              <div class="row">
                <!-- Content for each part -->
                <div class="col-sm-2">
                  <!-- Content for the fourth part -->
              </div>
             
              <div class="col-sm-2">
                  <!-- Content for the second part -->
                  <p>Size : {{ product_item.get_size_display }}</p>
              </div>
              <div class="col-sm-2">
                  <!-- Content for the third part -->
                  <p>Price : ₹{{ product_item.price }}</p>
              </div>
              <div class="col-sm-2">
                  <!-- Content for the third part -->
                 
                  {% if  product_item.quantity > 20 %}
                  <span class="badge rounded-pill bg-success">{{product_item.quantity}} - In-stock</span>
              {% elif product_item.quantity > 0 %}
                  <span class="badge rounded-pill bg-warning">{{product_item.quantity}} - Low-stock</span>
                  {% else %}
                  <span class="badge rounded-pill bg-danger">{{product_item.quantity}} - Out of stock</span>
              {% endif %}
              </div>
              <div class="col-sm-2">
                  <!-- Content for the fourth part -->
                  <button class="btn btn-primary btn-xs" data-bs-toggle="modal" data-bs-target="#exampleModal{{ product_item.id }}">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                        <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                        <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                      </svg>
                    </button>
              </div>
              <br>  
                
             
              </div>
            </div>
           <br>
            {% endfor %}
            {% endif %}
              

            {% endfor %}
            <div class="row mt-5">
              <div class="col d-flex justify-content-end">
                  {% if product.is_active %}
                  <!-- Content for the first part -->
                <a href="{% url 'dashboard:productstatus' product.id %}">  <button type="button" class="btn btn-warning" data-bs-dismiss="modal">Deactivate</button></a>
                  {% else %}
                  <!-- Content for the first part -->
                  <a href="{% url 'dashboard:productstatus' product.id %}">  <button type="button" class="btn btn-success " data-bs-dismiss="modal">activate</button></a>
                  {% endif %}
              </div>
              <div class="col text-center">
                  <!-- Content for the second part -->
                  <button type="button" class="btn" style="background-color: #20c997;" data-bs-toggle="modal" data-bs-target="#addvarient{{ product.id }}"><span style="size: 200%;">+</span> Variants</button>
                </div>
              <div class="col">
                  <!-- Content for the third part -->
                 <a href="{% url 'dashboard:deleteproduct' product.id %}"> <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Delete product</button></a>
              </div>
          </div>  
          </div>
        </div>
      </div>
      
    </div>
    
    <div class="modal fade" id="addvarient{{ product.id }}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Add Varients</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
              
              <div class="container">
                <form method="post" action="{% url 'dashboard:addproductitems' %}" enctype="multipart/form-data">
                  {% csrf_token %}

                    <div class="mb-4">
                      <input type="text" placeholder="Product" class="form-control" name="product" value="{{ product.id }}" hidden />
                    </div>
                  
                    <div class="mb-4">
                      <label for="size" class="form-label">Size</label>
                      <select class="form-select" id="size" name="size" aria-placeholder="Parent">
                        {% for size, label in size_choice %}
                          <option value="{{ size }}">{{ label }}</option>
                        {% endfor %}
                      </select>
                    </div>
                  
                    <div class="row">
                      <div class="col-lg-6">
                        <div class="mb-4">
                          <label for="price" class="form-label">Price</label>
                          <input type="number" placeholder="Price" class="form-control" id="price" name="price" />
                        </div>
                      </div>
                      <div class="col-lg-6">
                        <div class="mb-4">
                          <label for="quantity" class="form-label">Quantity</label>
                          <input type="number" placeholder="Quantity" class="form-control" id="quantity" name="quantity" />
                        </div>
                      </div>
                    </div>
                
                    <div class="row align-items-center">
                      <div class="col-sm-6">
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="flexSwitchCheckChecked" checked name="is_active">
                          <label class="form-check-label" for="flexSwitchCheckChecked">Active</label>
                        </div>
                      </div>
                      <div class="col-sm-6">
                        <div class="upload__box">
                          <div class="upload__img-wrap"></div>
                        </div>
                      </div>
                    </div>
                
                    <div class="form-group">
                      <div class="col-sm-10">
                        <input type="file" class="form-control image" name="photo" id="photo" accept=".png, .jpg, .jpeg" onchange="readFile(this);" multiple><button id="addImageBtn">Add Image</button>
                      </div>
                    </div>
                   
                  
                  <div id="status"></div>
                  <div id="photos" class="row"></div>
                </div>
                <div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
                  <div class="modal-dialog modal-lg" role="document">
                      <div class="modal-content">
                          <div class="modal-header">
                              <h5 class="modal-title" id="modalLabel">Crop image</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true">×</span>
                              </button>
                          </div>
                          <div class="modal-body">
                              <div class="img-container">
                                  <div class="row">
                                      <div class="col-md-8">  
                                          <!--  default image where we will set the src via jquery-->
                                          <img id="image">
                                      </div>
                                      <div class="col-md-4">
                                          <div class="preview"></div>
                                      </div>
                                  </div>
                              </div>
                          </div>
                          <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                              <button type="button" class="btn btn-primary" id="crop">Crop</button>
                          </div>
                      </div>
                  </div>
              </div>
      
          </div>
                   
<hr>                                                                      
                  <div class="mb-4">
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                  </div>
</form>
                
        </div>
      </div>
    </div>
    {% endfor %}






















        
        
    </main>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>
   
        <script defer src="https://cdn.crop.guide/loader/l.js?c=123ABC"></script>
        <script src="{% static 'dash_board/assets/js/vendors/jquery-3.6.0.min.js' %}"></script>
        <script src="{% static 'dash_board/assets/js/vendors/bootstrap.bundle.min.js' %}"></script>
        <script src="{% static 'dash_board/assets/js/vendors/select2.min.js' %}"></script>
        <script src="{% static 'dash_board/assets/js/vendors/perfect-scrollbar.js' %}"></script>
        <script src="{% static 'dash_board/assets/js/vendors/jquery.fullscreen.min.js' %}"></script>
        <script src="{% static 'dash_board/assets/js/vendors/chart.js' %}"></script>
        <!-- Main Script -->
        <script src="{% static 'dash_board/assets/js/main.js' %}" type="text/javascript"></script>
        <script src="{% static 'dash_board/assets/js/custom-chart.js' %}" type="text/javascript"></script>
        <script>
          var imageInput = document.getElementById('photo');

imageInput.addEventListener('change', function(event) {
  var files = event.target.files;

  // Process each selected file
  for (var i = 0; i < files.length; i++) {
    var file = files[i];

    // Perform operations with the selected file
    // Example: display the selected image
    var reader = new FileReader();
    reader.onload = function(e) {
      var img = document.createElement('img');
      img.src = e.target.result;
      document.getElementById('preview').appendChild(img);
    };
    reader.readAsDataURL(file);
  }
});
          function readFile(input) {
            $("#status").html('Processing...');
            var counter = input.files.length;
            for (var x = 0; x < counter; x++) {
              if (input.files && input.files[x]) {
                var reader = new FileReader();
        
                reader.onload = function (e) {
                  $("#photos").append('<div class="col-md-3 col-sm-3 col-xs-3"><img src="' + e.target.result + '" class="img-thumbnail"></div>');
                };
        
                reader.readAsDataURL(input.files[x]);
              }
            }
            if (counter == x) {
              $("#status").html('');
            }
          }
        </script>
      
      <!-- Add the necessary libraries and dependencies -->
{% comment %} 
<script>
  var bs_modal = $('#modal');
  var image = document.getElementById('image');
  var cropper, reader, files = [];

  $("body").on("change", ".image", function(e) {
    files = e.target.files;
    var done = function(url) {
      image.src = url;
      bs_modal.modal('show');
    };

    if (files && files.length > 0) {
      file = files[0];

      if (URL) {
        done(URL.createObjectURL(file));
      } else if (FileReader) {
        reader = new FileReader();
        reader.onload = function(e) {
          done(reader.result);
        };
        reader.readAsDataURL(file);
      }
    }
  });

  bs_modal.on('shown.bs.modal', function() {
    cropper = new Cropper(image, {
      aspectRatio: 1,
      viewMode: 3,
      preview: '.preview'
    });
  }).on('hidden.bs.modal', function() {
    cropper.destroy();
    cropper = null;
  });
  $(document).on("click", "#crop", function() {
    var croppedImages = [];
    var numFiles = files.length;
  
    // Validate the form fields before proceeding
    if (!validateForm()) {
      return;
    }

      // Loop through each selected file and crop it
  for (var i = 0; i < numFiles; i++) {
    var file = files[i];
    var canvas = cropper.getCroppedCanvas();
    canvas.toBlob(function(blob) {
      var croppedUrl = URL.createObjectURL(blob);
      $("#photos").append('<div class="col-md-3 col-sm-3 col-xs-3"><img src="' + croppedUrl + '" class="img-thumbnail"></div>');

      // Store the cropped image blob in the array
      croppedImages.push(blob);
        // Check if all files have been processed
        if (croppedImages.length === numFiles) {
          // Create a FormData object to store the cropped image blobs
          var formData = new FormData();
  
          // Add each cropped image blob to the FormData
          for (var j = 0; j < numFiles; j++) {
            formData.append('cropped_images', croppedImages[j]);
          }
          $("#cropped_images").val(croppedUrl);
  
          // Submit the form with the FormData
          $.ajax({
            beforeSend: function(xhr, settings) {
              xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token }}");
            },
            url: '{% url 'dashboard:addproductitems' %}',
            type: 'POST',
            data: formData,
            processData: false,
            contentType: false,
            success: function(response) {
              // Handle the success response
              console.log(response);
            },
            error: function(xhr, status, error) {
              // Handle the error response
              console.log(xhr.responseText);
            }
          });
        }
      });
    }
  
    bs_modal.modal('hide');
  });

  function validateForm() {
    // Perform validation on the form fields
    var product = $("#product").val();
    var size = $("#size").val();
    var price = $("#price").val();
    var quantity = $("#quantity").val();

    if (!product || !size || !price || !quantity) {
      // Display error message or perform any desired validation logic
      console.log("Please fill in all required fields.");
      return false;
    }

    return true;
  }
</script> {% endcomment %}
  {% comment %} <script>
  var bs_modal = $('#modal');
  var image = document.getElementById('image');
  var cropper, reader, files = [];

  $("body").on("change", ".image", function(e) {
    files = e.target.files;
    var done = function(url) {
      image.src = url;
      bs_modal.modal('show');
    };

    if (files && files.length > 0) {
      file = files[0];

      if (URL) {
        done(URL.createObjectURL(file));
      } else if (FileReader) {
        reader = new FileReader();
        reader.onload = function(e) {
          done(reader.result);
        };
        reader.readAsDataURL(file);
      }
    }
  });

  bs_modal.on('shown.bs.modal', function() {
    cropper = new Cropper(image, {
      aspectRatio: 1,
      viewMode: 3,
      preview: '.preview'
    });
  }).on('hidden.bs.modal', function() {
    cropper.destroy();
    cropper = null;
  });

  $("#crop").click(function() {
    var croppedImages = [];
    var numFiles = files.length;

    // Loop through each selected file and crop it
    for (var i = 0; i < numFiles; i++) {
      var file = files[i];
      var canvas = cropper.getCroppedCanvas();
      canvas.toBlob(function(blob) {
        var croppedUrl = URL.createObjectURL(blob);
        $("#photos").append('<div class="col-md-3 col-sm-3 col-xs-3"><img src="' + croppedUrl + '" class="img-thumbnail"></div>');

        // Store the cropped image blob in the array
        croppedImages.push(blob);

        // Check if all files have been processed
        if (croppedImages.length === numFiles) {
          // Create a FormData object to store the cropped image blobs
          var formData = new m();

          // Add each cropped image blob to the FormData
          for (var j = 0; j < numFiles; j++) {
            formData.append('cropped_images', croppedImages[j]);
          }

          $("#cropped_images").val(croppedUrl);

          // Get the CSRF token from the page
          var csrfToken = $('input[name="csrfmiddlewaretoken"]').val();

          // Include the CSRF token in the request headers
          $.ajaxSetup({
            headers: {
              'X-CSRFToken': csrfToken
            }
          });

          // Submit the form using AJAX
          $.ajax({
            url: '{% url 'dashboard:addproductitems' %}', // Replace with the correct URL
            type: 'POST',
            data: formData,
            processData: false,
            contentType: false,
            success: function(response) {
              console.log(response);
            },
            error: function(xhr, status, error) {
              console.log(xhr.responseText);
            }
          });
        }
      });
    }

    bs_modal.modal('hide');
  });
</script> {% endcomment %}


   
    </body>
    



<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/page-categories.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:33:21 GMT -->

</html>